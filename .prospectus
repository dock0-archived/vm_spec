Prospectus.extra_dep('file', 'prospectus_circleci')

require 'yaml'

item do
  noop

  deps do
    YAML.load(File.read('config.yaml'))['artifacts'].each do |artifact|
      aname, aversion = artifact.values_at('name', 'version')

      item do
        name "vm_spec::#{aname}"

        expected do
          github_release
          repo "dock0/#{aname}"
        end

        actual do
          static
          set aversion
        end
      end
    end
  end

  extend ProspectusCircleci::Build.new('dock0/vm_spec')
end
